<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-svar database = firebase.database();

console.log(database);


//write data to data base
let Name = prompt("Please enter your name", "")

function writeUserData() {
  let msg = document.querySelector("#msg").value
  database.ref('messages/').push().set({
    message: msg,
    name: Name
  });
}


//read data and give the input to the ui

database.ref('messages').on('child_added', (snapshot) => {
  let msgtoshow = snapshot.val();
  console.log(snapshot.key)

  /*for(let key in msgtoshow){
      var showthemsg = msgtoshow[key];
      
  }*/

  if (Name == msgtoshow.name) {
    var figure = document.createElement("figure");
    figure.setAttribute("class", "right");
    var image = document.createElement("img");
    image.id = "Id";
    image.className = "class";
    image.src = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQpdX6tPX96Zk00S47LcCYAdoFK8INeCElPeJrVDrh8phAGqUZP_g";
    figure.appendChild(image)
    var x = document.createElement("P");
    var t = document.createTextNode(` ${msgtoshow.message}`);
    x.appendChild(t);
    //x.appendChild(figure) 
    document.getElementById('showmsg').appendChild(figure)
    figure.appendChild(x)
    // document.getElementById('showmsg').appendChild(x);

  }
  else {
    var figure = document.createElement("figure");
    figure.setAttribute("class", "left");
    var image = document.createElement("img");
    image.id = "Id";
    image.className = "class";
    image.src = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQpdX6tPX96Zk00S47LcCYAdoFK8INeCElPeJrVDrh8phAGqUZP_g";
    figure.appendChild(image)
    var x = document.createElement("P");
    var t = document.createTextNode(`${msgtoshow.message}`);
    x.appendChild(t);
    //x.appendChild(figure) 
    document.getElementById('showmsg').appendChild(figure)
    figure.appendChild(x)
    // document.getElementById('showmsg').appendChild(x);
  }




  var msgscroll = document.querySelector("#showmsg");


  autoscrool();
  function autoscrool() {
    msgscroll.scrollTop = msgscroll.scrollHeight;
  }
  // console.log(t);
});
//use enter key to send msg

document.addEventListener("keypress", function (e) {
  //console.log(e.key);
  if (e.key === "Enter") {
    writeUserData();
  }
})
//delete msg 

/*database.ref("messages/").on("child_removed", function (snapshot) {
    document.getElementById("showmsg-" + snapshot.key).innerHTML = "This message has been deleted";
  });

  function deleteMessage(self) {
    var messageId = self.getAttribute("data-id");
    database.ref("messages").child(messageId).remove();
  }*/
document.getElementById("del").addEventListener("click", function () {
  database.ref('messages/').remove()
})



  //


cale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Chat Room</title>
</head>

<body>



  <div class="head">

    <figure class="avatar">
      <img
        src="https://p7.hiclipart.com/preview/349/273/275/livechat-online-chat-computer-icons-chat-room-web-chat-others.jpg" />
    </figure>

    <h1>Chat Room <br>
      Made with ‚ù§ By souvik
    </h1>
  </div>
  <div id="showmsg">

    <!-- <p>souvik: hello</p> -->
  </div>
  <textarea id="msg" rows="5" placeholder="Type Text Here..."></textarea>
  <button id="btn" onclick="writeUserData()">Send</button>

  /*<button id="del">delete message</button>*/






  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-analytics.js"></script>

  <script>
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    var firebaseConfig = {
      apiKey: "AIzaSyA16wLe6B-c1ANtuenmedSTbRRX8Gfh8Rs",
      authDomain: "chat-app-4332a.firebaseapp.com",
      databaseURL: "https://chat-app-4332a-default-rtdb.firebaseio.com",
      projectId: "chat-app-4332a",
      storageBucket: "chat-app-4332a.appspot.com",
      messagingSenderId: "621573564114",
      appId: "1:621573564114:web:e1f1bb24da2d19964faf0b",
      measurementId: "G-3CMSE0HM0Q"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
  </script>

  <!-- external js -->
  <script src="chat_room_code.js"></script>
</body>

</html>
